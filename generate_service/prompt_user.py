grade="grade"
subject="subject"
name="name"
date_str="date_str"
parts=[]
field=[]
kw_bullets=[]

# 1차 생성 유저 프롬포트
USER_PROMPT1_DETAIL = """
[요청 목적]
'{field}' 분야 관점에서 '{subject}' 교과의 세부능력 및 특기사항 문단을 작성하라.
입력된 키워드만을 근거로, 과장·추측 없이 사실 중심으로 기술한다.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 학년: {grade}
- 과목: {subject}
- 이름: {name}
- 분야: {field}

[키워드 목록]
{kw_bullets}

────────────────────────────
📋 작성 규칙
────────────────────────────
- 입력 키워드 외 새로운 사실 생성 금지
- 명사형 종결(~함) 유지
- 객관적 서술체, 교사 관찰 시점 유지
- 긍정적이되 과장·절대어(항상, 완벽, 최고 등) 금지
- 문장 수: 1~2문장
- 길이: 약 150자
- 날짜, 인명, 장소명, 감정 표현 금지
────────────────────────────
출력 형태:
해당 분야의 관찰 내용을 자연스러운 한 단락으로 작성하라.
────────────────────────────
"""

USER_PROMPT1_BEHAVIOR = """
────────────────────────────
📋 [행동특성 및 종합의견 1차 생성 프롬프트]
────────────────────────────

[요청 목적]
'{field}' 관점에서 '{name}'의 학교생활 행동특성 및 종합의견 문단을 작성하라.
입력 키워드를 중심으로 사실적이고 균형 있게 기술하며, 과장·추측·감정 표현은 금지한다.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 카테고리: 행동특성및종합의견
- 이름: {name}
- 분야: {field}        # 예: 책임감, 협업, 자기관리, 공감/배려
- 키워드 목록:
{kw_bullets}

────────────────────────────
📘 작성 원칙
────────────────────────────
1️⃣ 입력 키워드 외 새로운 정보 생성 금지  
2️⃣ 명사형 종결(~함, ~보임) 유지  
3️⃣ 교사 관찰체 문체 사용, 학생 직접 지칭 금지  
4️⃣ 긍정적이되 과장·절대어 금지 (“항상, 최고, 완벽” 등)  
5️⃣ 감정·성격 판단, 미래 예단, 민감 정보 금지  
6️⃣ 부정적 사례는 개선 과정과 변화로 마무리  
7️⃣ 권장 분량: 약 150~200자, 1~2문장  

────────────────────────────

출력: 해당 분야의 행동특성과 개선 흐름을 포함한 한 단락
"""

USER_PROMPT1_ACTIVITY = """
────────────────────────────
📋 [창의적 체험활동 1차 생성 프롬프트]
────────────────────────────

[요청 목적]
'{subject}' 영역에서 '{field}' 관점으로 '{name}'의 창의적 체험활동 내용을 작성하라.  
입력 키워드를 근거로 활동의 맥락, 참여 행동, 배운 점을 서사형으로 기술하되  
과장·추측·감정 표현을 금지한다.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 카테고리: 창의적체험활동
- 영역(Subject): {subject}     # 자율 / 봉사 / 진로 / 동아리
- 분야(Field): {field}         # 기획 / 협업 / 문제해결 / 리더십 등
- 이름: {name}
- 키워드 목록:
{kw_bullets}

────────────────────────────
📘 작성 원칙
────────────────────────────
1️⃣ 입력 키워드 외 새로운 사실 생성 금지  
2️⃣ 활동 맥락 → 참여 행동 → 배운 점(역량·태도) 순서로 구성  
3️⃣ 명사형 종결(~함, ~보임, ~발휘함) 유지  
4️⃣ 교사 관찰체 문체 사용, 학생 직접 지칭 금지  
5️⃣ 감정 표현·성격 단정·미래 예단 금지  
6️⃣ 장소·날짜·기관명 등 개인정보 배제  
7️⃣ 부정 사례는 개선 노력 중심으로 마무리  
8️⃣ 권장 분량: 150~200자 (1~2문장)

────────────────────────────

출력: {subject} 영역의 '{field}' 관점에서 활동의 과정과 결과를 1단락으로 작성
"""


# 2차 생성 유저 프롬포트

USER_PROMPT2_DETAIL = """
[요청 목적]
아래 1차 생성된 문단들을 바탕으로, 중복을 제거하고 1차 생성된 문단들 간의 흐름을 부드럽고 자연스럽게 연결하여
'{subject}' 교과의 세부능력 및 특기사항 최종 문단을 완성하라.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 학년: {grade}
- 과목: {subject}
- 이름: {name}
- 날짜: {date_str}

[1차 생성 문단들]
{parts}

────────────────────────────
📋 작성 규칙
────────────────────────────
- 기존 문장 외 새로운 정보 추가 금지
- 중복 표현 축약, 핵심만 연결
- 명사형 종결(~함)
- 객관적 교사 서술체 유지
- 길이 약 400자
- 날짜, 인명, 장소명, 감정 표현 금지
────────────────────────────
출력 형태:
최종 완성된 한 단락의 세부능력 및 특기사항 문장으로 작성하라. 한번만 출력할 것.
────────────────────────────
"""


USER_PROMPT2_BEHAVIOR = """
────────────────────────────
📋 [행동특성 및 종합의견 최종 통합 프롬프트]
────────────────────────────

[요청 목적]
아래 1차 문단들을 통합하여 '{name}'의 학교생활 전반 행동특성 및 종합의견 최종 문단을 작성하라.
중복을 제거하고 문장 간 논리적 연결을 강화하며, 구체적 개선과 성장의 흐름을 드러낸다.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 카테고리: 행동특성및종합의견
- 이름: {name}
- 날짜: {date_str}
- 입력 문단 목록:
{parts}

────────────────────────────
📘 작성 원칙
────────────────────────────
1️⃣ 기존 문장 외 새로운 정보 추가 금지  
2️⃣ 중복·불필요 표현 제거, 핵심 연결  
3️⃣ 명사형 종결(~함, ~보임) 유지  
4️⃣ 교사 관찰체 문체, 객관적이고 포용적 어조 유지  
5️⃣ 성격 단정·감정 서술·예단 표현 금지  
6️⃣ 개선 과정 및 변화 흐름을 반드시 포함  
7️⃣ 권장 분량: 400~450자  

────────────────────────────
📘 문장 흐름 가이드
────────────────────────────
- 기본 태도 → 대인관계/협업 → 자기관리 → 변화·성장 서사  
- 각 항목은 자연스럽게 연결되되, 나열식이 아닌 서사 구조로 통합  

────────────────────────────

출력: 완성된 행동특성 및 종합의견 문단 (명사형 종결, 약 400~450자)
"""

USER_PROMPT2_ACTIVITY = """
────────────────────────────
📋 [창의적 체험활동 2차 통합 프롬프트]
────────────────────────────

[요청 목적]
아래 1차 문단들을 통합하여 '{name}'의 '{subject}' 영역 창의적 체험활동 문단을 완성하라.  
중복을 제거하고 문장 간 논리적 흐름을 강화하며, 활동의 전개와 배운 점이 자연스럽게 이어지도록 구성한다.

────────────────────────────
🧾 입력 메타데이터
────────────────────────────
- 카테고리: 창의적체험활동
- 영역(Subject): {subject}
- 이름: {name}
- 날짜: {date_str}
- 입력 문단 목록:
{parts}

────────────────────────────
📘 작성 원칙
────────────────────────────
1️⃣ 기존 문장 외 새로운 정보 추가 금지  
2️⃣ 중복·군더더기 제거 후 핵심 내용 연결  
3️⃣ 활동 맥락 → 참여 행동 → 배운 점(역량·태도) 순서 유지  
4️⃣ 명사형 종결(~함, ~보임, ~발휘함) 유지  
5️⃣ 교사 관찰체 문체, 학생 직접 지칭 금지  
6️⃣ 감정·성격 판단·예단 표현 금지  
7️⃣ 권장 분량: 250~400자 (2~3문장)

────────────────────────────
📘 문장 흐름 가이드
────────────────────────────
- 도입(맥락): 활동 계기·목표·역할  
- 전개(행동): 수행 과정, 협업, 문제 해결  
- 결말(성과): 얻은 역량, 태도 변화, 성장 의미  

────────────────────────────
출력: '{subject}' 영역 창의적 체험활동 최종 문단 (명사형 종결, 250~400자)
"""

USER_PROMPT_MAP = {
     "세부능력및특기사항": {
         "field": USER_PROMPT1_DETAIL,
         "final": USER_PROMPT2_DETAIL,
     },
     "행동특성및종합의견": {
         "field": USER_PROMPT1_BEHAVIOR,
         "final": USER_PROMPT2_BEHAVIOR,
     },
     "창의적체험활동": {
         "field": USER_PROMPT1_ACTIVITY,
         "final": USER_PROMPT2_ACTIVITY,
     },
 }

def get_user_prompt(category: str, stage: str) -> str:
    """
    category: '세부능력및특기사항' / '행동특성및종합의견' / '창의적체험활동'
    stage: 'field' (1차), 'final' (2차)
    """
    if category not in USER_PROMPT_MAP:
        raise ValueError(f"지원하지 않는 category: {category}")
    if stage not in USER_PROMPT_MAP[category]:
        raise ValueError(f"지원하지 않는 stage: {stage}")
    return USER_PROMPT_MAP[category][stage]
